# 2. 서블릿

##  웹서버 / 웹애플리케이션 서버
- 웹서버: 정적인 페이지를 클라이언트에게 제공
- 웹애플리케이션 서버: 요청, 시간 등에 따라 동적인 웹페이지를 클라이언트에게 제공
<br>
<br>
## 서블릿
요청-응답 프로그래밍 모델의 서버를 구현하기 위해 사용되는 Jakarta 프레임워크의 구성요소

모든 요청과 응답과정을 개발자가 일일히 처리하는 것은 힘드므로, 서블릿이 이를 메서드만으로 체계적으로 다룰 수 있게 해준다.
- 서블릿은 요청-응답 프로그래밍 모델의 서버를 구현하기 위한 **인터페이스**이다.
- 서블릿은 일반적으로 웹 어플리케이션에서 HTTP 요청과 응답을 처리하는데에 많이 사용되지만, HTTP에 국한된 것이 아니다.
- 우리는 HTTP 통신을 위한 서블릿 인터페이스를 구현하기 귀해 HttpServlet을 상속받아 우리만의 서블릿을 구현한다.
- 개발자는 서블릿을 지원하는 WAS(Web Application Server)를 사용하여 비즈니스 로직 구현에 집중할 수 있다.
<br>
<br>
## 서블릿 컨테이너 (Web Container)
서블릿 객체를 담아주고 관리해 주는 컨테이너. 톰캣처럼 서블릿을 지원하는 WAS를 서블릿 컨테이너라고 한다.

**서블릿 객체**의 생명주기를 관리하고, 동시요청을 위한 멀티쓰레드 처리를 지원한다.
<br>
<br>
## 웹애플리케이션 서버의 요청 응답 구조
1. 웹브라우저가 서버에 HTTP 요청을 보낸다.
2. 내장 톰캣 서버(WAS)는 HTTP 요청 메세지를 기반으로 request, response 객체를 생성한다.
3. 생성된 객체를 서블릿 컨테이너에 만들어져 있는 서블릿 객체에 넘겨준다.
4. 서블릿 객체 내부에서 요청을 모두 처리하고 response 객체를 반환한다.
5. 서버는 반환된 response 객체정보를 바탕으로 HTTP 응답을 생성해 클라이언트에게 다시 전송한다.

---

## Servlet 자동등록
- **ServletComponentScan** 어노테이션을 이용해 Servlet을 자동으로 등록할 수 있다.
- **ServletComponentScan** 이 동작하면 **@WebServlet** 어노테이션이 붙어있는 클래스를 서블릿 컨테이너에 빈으로 등록한다.
- Servlet 객체가 호출되면 service 메서드가 자동으로 호출되며, service 메서드를 오버라이드 하려면, 추상클래스인 **HttpServlet**를 상속받아야 한다.
- service 메소드 안에는 비즈니스 로직을 작성하며 Response의 결과물을 생성한다.
<br>
<br>
## 로깅
application.properties에 `logging.level.org.apache.coyote.http11=debug`를 추가해서 요청 정보를 자세하게 확인할 수 있다.

단, 실제 운영서버에서 모든 요청정보를 다 남기면 성능저하가 발생할 수 있다.
<br>
<br>
## HTTP 요청 데이터
클라이언트에서 서버로 메세지를 보내는 방법에는 3가지가 있다.

1. GET - 쿼리 파라미터
   - 메세지 바디 없이, URL의 쿼리 파라미터에 데이터를 포함해서 전달하는 방식
2. POST - HTML Form을 이용한 방식
   - HTML Form 태그를 이용해 메세지 바디에 쿼리 파라미터 형식으로 전달하는 방식
3. HTTP message body에 데이터를 직접 담아서 요청
   - HTTP API에서 주로 사용
   - JSON 형식을 주로 사용한다.
<br>
<br>
## HTTP 응답 데이터
1. 텍스트 응답
2. HTML 응답
3. JSON 응답
